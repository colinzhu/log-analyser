<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">
    <title>Log Grep</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2.0.6/css/pico.min.css"/>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.5/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pako@2.0.4/dist/pako.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.7.1/dist/jszip.min.js"></script>
    <script src="main.js"></script>
</head>

<body x-data="appData">
    <nav class="container-fluid">
        <h1>Log Grep</h1>
    </nav>

    <main class="container-fluid">
        <div>
            <label for="fileInput">Select a text file (.gz / .zip / plain text):</label>
            <input type="file" id="fileInput" @change="onFileChanged"/>
        </div>

        <div x-show="fileInput == null">
            <label for="textInput">Or input text:</label>
            <textarea id="textInput" rows="2" autoFocus placeholder="Text / log to be filtered" x-model="textInput"></textarea>
        </div>

        <div class="grid">
            <div>
                <label for="includeInput">
                    Contain Keywords 
                    <small>case-insensitive <input type="checkbox" x-model="includeInputCase"/></small>
                </label>
                <input id="includeInput" placeholder="keywords to be included, separated by space" x-model="includeInput"/>
            </div>

            <div>
                <label for="excludeInput">
                    Exclude Keywords 
                    <small>case-insensitive <input type="checkbox" x-model="excludeInputCase"/></small>
                </label>
                <input id="excludeInput" placeholder="keywords to be excluded, separated by space" x-model="excludeInput"/>
            </div>

            <div>
                <label for="hideInput">
                    Hide text 
                    <small>case-insensitive <input type="checkbox" x-model="hideInputCase"/></small>
                </label>
                <input id="hideInput" placeholder="texts to be hidden, separated by space" x-model="hideInput"/>
            </div>

            <div>
                <label for="outputLimit">Output limit</label>
                <select id="outputLimit" x-model="outputLimit">
                    <option value="10000">10000</option>
                    <option value="1000">1000</option>
                    <option value="100">100</option>
                    <option value="50">50</option>
                    <option value="10">10</option>
                    <option value="999999999">no limit</option>
                </select>
            </div>
        </div>

        <div>
            <button @click="renderResult" x-bind:aria-busy="isProcessing" x-bind:disabled="isProcessing">Search</button>
            <button @click="reset">Reset</button>
            <button @click="sortResult('asc')" x-show="resultLineCount > 1">Sort asc</button>
            <button @click="sortResult('desc')" x-show="resultLineCount > 1">Sort desc</button>
            <button @click="toggleWrap" x-text="isWrap ? 'nowrap' : 'wrap'" x-show="resultLineCount > 1"></button>
        </div>

        <div style="margin-top:1em">
            <mark>Total lines: <span x-text="resultLineCount"></span></mark>
        </div>

        <div id="result" x-bind:style="isWrap ? 'white-space: normal' : 'white-space: nowrap'"></div>
    </main>
</body>
</html>